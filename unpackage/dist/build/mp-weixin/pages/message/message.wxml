<view><view data-event-opts="{{[['touchstart',[['hideDrawer',['$event']]]]]}}" class="content" bindtouchstart="__e"><scroll-view class="msg-list" scroll-y="true" scroll-with-animation="{{scrollAnimation}}" scroll-top="{{scrollTop}}" scroll-into-view="{{scrollToView}}" upper-threshold="50" data-event-opts="{{[['scrolltoupper',[['loadHistory',['$event']]]]]}}" bindscrolltoupper="__e"><view class="loading"><view class="spinner"><view class="rect1"></view><view class="rect2"></view><view class="rect3"></view><view class="rect4"></view><view class="rect5"></view></view></view><block wx:for="{{msgs}}" wx:for-item="row" wx:for-index="index" wx:key="index"><view class="row" id="{{'msg'+row.id}}"><block wx:if="{{row.isSys}}"><block><view class="system"><block wx:if="{{row.type=='text'}}"><view class="text">{{row.msg}}</view></block><block wx:if="{{row.type=='redEnvelope'}}"><view class="red-envelope"><image src="/static/img/red-envelope-chat.png"></image>{{''+row.msg+''}}</view></block></view></block></block><block wx:if="{{!row.isSys}}"><block><block wx:if="{{row.isme}}"><view class="my"><view class="left"><block wx:if="{{row.type=='text'}}"><view class="bubble"><rich-text nodes="{{row.msg}}"></rich-text></view></block><block wx:if="{{row.type=='voice'}}"><view data-event-opts="{{[['tap',[['playVoice',['$0'],[[['msgs','',index]]]]]]]}}" class="{{['bubble voice',playMsgid==row.id?'play':'']}}" bindtap="__e"><view class="length">{{row.voiceLength}}</view><view class="icon my-voice"></view></view></block><block wx:if="{{row.type=='img'}}"><view data-event-opts="{{[['tap',[['showPic',['$0'],[[['msgs','',index]]]]]]]}}" class="bubble img" bindtap="__e"><image style="{{'width:'+(row.img.w+'px')+';'+('height:'+(row.img.h+'px')+';')}}" src="{{row.msg}}"></image></view></block></view><view class="right"><block wx:if="{{row.isme}}"><u-col vue-id="{{'7ac9e6a0-1-'+index}}" bind:__l="__l" vue-slots="{{['default']}}"><avatar vue-id="{{('7ac9e6a0-2-'+index)+','+('7ac9e6a0-1-'+index)}}" size="80" mode="square" bind:__l="__l"></avatar></u-col></block></view></view></block><block wx:if="{{!row.isme}}"><view class="other"><view class="left"><block wx:if="{{!row.isme}}"><u-col vue-id="{{'7ac9e6a0-3-'+index}}" span="2" bind:__l="__l" vue-slots="{{['default']}}"><avatar vue-id="{{('7ac9e6a0-4-'+index)+','+('7ac9e6a0-3-'+index)}}" size="80" mode="square" bind:__l="__l"></avatar></u-col></block></view><view class="right"><view class="username"><view hidden="{{!(action==2)}}" class="name">{{optionName}}</view><view hidden="{{!(action==3)}}" class="name">{{row.sourceName}}</view><view class="time">{{row.time}}</view></view><block wx:if="{{row.type=='text'}}"><view class="bubble"><rich-text nodes="{{row.msg}}"></rich-text></view></block><block wx:if="{{row.type=='voice'}}"><view data-event-opts="{{[['tap',[['playVoice',['$0'],[[['msgs','',index]]]]]]]}}" class="{{['bubble voice',playMsgid==row.id?'play':'']}}" bindtap="__e"><view class="icon other-voice"></view><view class="length">{{row.voiceLength}}</view></view></block><block wx:if="{{row.type=='img'}}"><view data-event-opts="{{[['tap',[['showPic',['$0'],[[['msgs','',index]]]]]]]}}" class="bubble img" bindtap="__e"><image style="{{'width:'+(row.img.w+'px')+';'+('height:'+(row.img.h+'px')+';')}}" src="{{row.msg}}"></image></view></block></view></view></block></block></block></view></block></scroll-view></view><view data-event-opts="{{[['touchmove',[['discard',['$event']]]]]}}" class="{{['popup-layer',popupLayerClass]}}" catchtouchmove="__e"><swiper class="{{['emoji-swiper',(hideEmoji)?'hidden':'']}}" indicator-dots="true" duration="150"><block wx:for="{{emojiList}}" wx:for-item="page" wx:for-index="pid" wx:key="pid"><swiper-item><block wx:for="{{page}}" wx:for-item="em" wx:for-index="eid" wx:key="eid"><view data-event-opts="{{[['tap',[['addEmoji',['$0'],[[['emojiList','',pid],['','',eid]]]]]]]}}" bindtap="__e"><image mode="widthFix" src="{{'/static/img/emoji/'+em.url}}"></image></view></block></swiper-item></block></swiper><view class="{{['more-layer',(hideMore)?'hidden':'']}}"><view class="list"><view data-event-opts="{{[['tap',[['chooseImage',['$event']]]]]}}" class="box" bindtap="__e"><view class="icon tupian2"></view></view><view data-event-opts="{{[['tap',[['camera',['$event']]]]]}}" class="box" bindtap="__e"><view class="icon paizhao"></view></view><view data-event-opts="{{[['tap',[['handRedEnvelopes',['$event']]]]]}}" class="box" bindtap="__e"><view class="icon hongbao"></view></view></view></view></view><view data-event-opts="{{[['touchmove',[['discard',['$event']]]]]}}" class="{{['input-box',popupLayerClass]}}" catchtouchmove="__e"><view class="voice"><view data-event-opts="{{[['tap',[['switchVoice',['$event']]]]]}}" class="{{['icon',isVoice?'jianpan':'yuyin']}}" bindtap="__e"></view></view><view class="textbox"><view data-event-opts="{{[['touchstart',[['voiceBegin',['$event']]]],['touchmove',[['voiceIng',['$event']]]],['touchend',[['voiceEnd',['$event']]]],['touchcancel',[['voiceCancel',['$event']]]]]}}" class="{{['voice-mode',isVoice?'':'hidden',recording?'recording':'']}}" bindtouchstart="__e" catchtouchmove="__e" bindtouchend="__e" bindtouchcancel="__e">{{''+voiceTis+''}}</view><view class="{{['text-mode',isVoice?'hidden':'']}}"><view class="box"><textarea auto-height="true" data-event-opts="{{[['focus',[['textareaFocus',['$event']]]],['input',[['__set_model',['','textMsg','$event',[]]]]]]}}" value="{{textMsg}}" bindfocus="__e" bindinput="__e"></textarea></view><view data-event-opts="{{[['tap',[['chooseEmoji',['$event']]]]]}}" class="em" bindtap="__e"><view class="icon biaoqing"></view></view></view></view><view data-event-opts="{{[['tap',[['showMore',['$event']]]]]}}" class="more" bindtap="__e"><view class="icon add"></view></view><view data-event-opts="{{[['tap',[['sendText',['$event']]]]]}}" class="{{['send',isVoice?'hidden':'']}}" bindtap="__e"><view class="btn">发送</view></view></view><view class="{{['record',recording?'':'hidden']}}"><view class="{{['ing',willStop?'hidden':'']}}"><view class="icon luyin2"></view></view><view class="{{['cancel',willStop?'':'hidden']}}"><view class="icon chehui"></view></view><view class="{{['tis',willStop?'change':'']}}">{{recordTis}}</view></view></view>