(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/message/message"],{"347e":function(i,e,t){"use strict";t.r(e);var s=t("9be5"),g=t.n(s);for(var n in s)"default"!==n&&function(i){t.d(e,i,(function(){return s[i]}))}(n);e["default"]=g.a},"441a":function(i,e,t){"use strict";var s=t("7493"),g=t.n(s);g.a},7493:function(i,e,t){},"765e":function(i,e,t){"use strict";(function(i){t("18cc");s(t("66fd"));var e=s(t("9ecb"));function s(i){return i&&i.__esModule?i:{default:i}}i(e.default)}).call(this,t("543d")["createPage"])},"9be5":function(i,e,t){"use strict";(function(i){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;n(t("312b"));var s=t("2f62"),g=t("fc81");function n(i){return i&&i.__esModule?i:{default:i}}function o(i,e){var t=Object.keys(i);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(i);e&&(s=s.filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable}))),t.push.apply(t,s)}return t}function r(i){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?o(Object(t),!0).forEach((function(e){l(i,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(t,e))}))}return i}function l(i,e,t){return e in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}var a=function(){t.e("components/avatar/avatar").then(function(){return resolve(t("3c0c"))}.bind(null,t)).catch(t.oe)},f={computed:r({},(0,s.mapState)(["userName","isOnLine","msgList","socketTask","friendList","groupList"])),components:{avatar:a},data:function(){return{textInput:!0,imgData:"",inputPosition:0,positionTop:0,action:2,indexRegion:"",listPage:0,isOver:!1,curDate:"1588061853944",conversion:!0,msgInput:{msg1:"",msg2:""},moreIsOpen:!1,msgBody:{header:{length:1e4,isImg:!1,isText:!1,isVoice:!1},sourceAccount:"",receiveAccount:"",action:2,time:0,msgBody:""},msgs:[],hisMsgs:[],optionName:"",textMsg:"",isHistoryLoading:!1,scrollAnimation:!1,scrollTop:0,scrollToView:"",msgImgList:[],myuid:0,RECORDER:i.getRecorderManager(),isVoice:!1,voiceTis:"按住 说话",recordTis:"手指上滑 取消发送",recording:!1,willStop:!1,initPoint:{identifier:0,Y:0},recordTimer:null,recordLength:0,AUDIO:i.createInnerAudioContext(),playMsgid:null,VoiceTimer:null,popupLayerClass:"",hideMore:!0,hideEmoji:!0,emojiList:[[{url:"100.gif",alt:"[微笑]"},{url:"101.gif",alt:"[伤心]"},{url:"102.gif",alt:"[美女]"},{url:"103.gif",alt:"[发呆]"},{url:"104.gif",alt:"[墨镜]"},{url:"105.gif",alt:"[哭]"},{url:"106.gif",alt:"[羞]"},{url:"107.gif",alt:"[哑]"},{url:"108.gif",alt:"[睡]"},{url:"109.gif",alt:"[哭]"},{url:"110.gif",alt:"[囧]"},{url:"111.gif",alt:"[怒]"},{url:"112.gif",alt:"[调皮]"},{url:"113.gif",alt:"[笑]"},{url:"114.gif",alt:"[惊讶]"},{url:"115.gif",alt:"[难过]"},{url:"116.gif",alt:"[酷]"},{url:"117.gif",alt:"[汗]"},{url:"118.gif",alt:"[抓狂]"},{url:"119.gif",alt:"[吐]"},{url:"120.gif",alt:"[笑]"},{url:"121.gif",alt:"[快乐]"},{url:"122.gif",alt:"[奇]"},{url:"123.gif",alt:"[傲]"}],[{url:"124.gif",alt:"[饿]"},{url:"125.gif",alt:"[累]"},{url:"126.gif",alt:"[吓]"},{url:"127.gif",alt:"[汗]"},{url:"128.gif",alt:"[高兴]"},{url:"129.gif",alt:"[闲]"},{url:"130.gif",alt:"[努力]"},{url:"131.gif",alt:"[骂]"},{url:"132.gif",alt:"[疑问]"},{url:"133.gif",alt:"[秘密]"},{url:"134.gif",alt:"[乱]"},{url:"135.gif",alt:"[疯]"},{url:"136.gif",alt:"[哀]"},{url:"137.gif",alt:"[鬼]"},{url:"138.gif",alt:"[打击]"},{url:"139.gif",alt:"[bye]"},{url:"140.gif",alt:"[汗]"},{url:"141.gif",alt:"[抠]"},{url:"142.gif",alt:"[鼓掌]"},{url:"143.gif",alt:"[糟糕]"},{url:"144.gif",alt:"[恶搞]"},{url:"145.gif",alt:"[什么]"},{url:"146.gif",alt:"[什么]"},{url:"147.gif",alt:"[累]"}],[{url:"148.gif",alt:"[看]"},{url:"149.gif",alt:"[难过]"},{url:"150.gif",alt:"[难过]"},{url:"151.gif",alt:"[坏]"},{url:"152.gif",alt:"[亲]"},{url:"153.gif",alt:"[吓]"},{url:"154.gif",alt:"[可怜]"},{url:"155.gif",alt:"[刀]"},{url:"156.gif",alt:"[水果]"},{url:"157.gif",alt:"[酒]"},{url:"158.gif",alt:"[篮球]"},{url:"159.gif",alt:"[乒乓]"},{url:"160.gif",alt:"[咖啡]"},{url:"161.gif",alt:"[美食]"},{url:"162.gif",alt:"[动物]"},{url:"163.gif",alt:"[鲜花]"},{url:"164.gif",alt:"[枯]"},{url:"165.gif",alt:"[唇]"},{url:"166.gif",alt:"[爱]"},{url:"167.gif",alt:"[分手]"},{url:"168.gif",alt:"[生日]"},{url:"169.gif",alt:"[电]"},{url:"170.gif",alt:"[炸弹]"},{url:"171.gif",alt:"[刀子]"}],[{url:"172.gif",alt:"[足球]"},{url:"173.gif",alt:"[瓢虫]"},{url:"174.gif",alt:"[翔]"},{url:"175.gif",alt:"[月亮]"},{url:"176.gif",alt:"[太阳]"},{url:"177.gif",alt:"[礼物]"},{url:"178.gif",alt:"[抱抱]"},{url:"179.gif",alt:"[拇指]"},{url:"180.gif",alt:"[贬低]"},{url:"181.gif",alt:"[握手]"},{url:"182.gif",alt:"[剪刀手]"},{url:"183.gif",alt:"[抱拳]"},{url:"184.gif",alt:"[勾引]"},{url:"185.gif",alt:"[拳头]"},{url:"186.gif",alt:"[小拇指]"},{url:"187.gif",alt:"[拇指八]"},{url:"188.gif",alt:"[食指]"},{url:"189.gif",alt:"[ok]"},{url:"190.gif",alt:"[情侣]"},{url:"191.gif",alt:"[爱心]"},{url:"192.gif",alt:"[蹦哒]"},{url:"193.gif",alt:"[颤抖]"},{url:"194.gif",alt:"[怄气]"},{url:"195.gif",alt:"[跳舞]"}],[{url:"196.gif",alt:"[发呆]"},{url:"197.gif",alt:"[背着]"},{url:"198.gif",alt:"[伸手]"},{url:"199.gif",alt:"[耍帅]"},{url:"200.png",alt:"[微笑]"},{url:"201.png",alt:"[生病]"},{url:"202.png",alt:"[哭泣]"},{url:"203.png",alt:"[吐舌]"},{url:"204.png",alt:"[迷糊]"},{url:"205.png",alt:"[瞪眼]"},{url:"206.png",alt:"[恐怖]"},{url:"207.png",alt:"[忧愁]"},{url:"208.png",alt:"[眨眉]"},{url:"209.png",alt:"[闭眼]"},{url:"210.png",alt:"[鄙视]"},{url:"211.png",alt:"[阴暗]"},{url:"212.png",alt:"[小鬼]"},{url:"213.png",alt:"[礼物]"},{url:"214.png",alt:"[拜佛]"},{url:"215.png",alt:"[力量]"},{url:"216.png",alt:"[金钱]"},{url:"217.png",alt:"[蛋糕]"},{url:"218.png",alt:"[彩带]"},{url:"219.png",alt:"[礼物]"}]],onlineEmoji:{"100.gif":"AbNQgA.gif","101.gif":"AbN3ut.gif","102.gif":"AbNM3d.gif","103.gif":"AbN8DP.gif","104.gif":"AbNljI.gif","105.gif":"AbNtUS.gif","106.gif":"AbNGHf.gif","107.gif":"AbNYE8.gif","108.gif":"AbNaCQ.gif","109.gif":"AbNN4g.gif","110.gif":"AbN0vn.gif","111.gif":"AbNd3j.gif","112.gif":"AbNsbV.gif","113.gif":"AbNwgs.gif","114.gif":"AbNrD0.gif","115.gif":"AbNDuq.gif","116.gif":"AbNg5F.gif","117.gif":"AbN6ET.gif","118.gif":"AbNcUU.gif","119.gif":"AbNRC4.gif","120.gif":"AbNhvR.gif","121.gif":"AbNf29.gif","122.gif":"AbNW8J.gif","123.gif":"AbNob6.gif","124.gif":"AbN5K1.gif","125.gif":"AbNHUO.gif","126.gif":"AbNIDx.gif","127.gif":"AbN7VK.gif","128.gif":"AbNb5D.gif","129.gif":"AbNX2d.gif","130.gif":"AbNLPe.gif","131.gif":"AbNjxA.gif","132.gif":"AbNO8H.gif","133.gif":"AbNxKI.gif","134.gif":"AbNzrt.gif","135.gif":"AbU9Vf.gif","136.gif":"AbUSqP.gif","137.gif":"AbUCa8.gif","138.gif":"AbUkGQ.gif","139.gif":"AbUFPg.gif","140.gif":"AbUPIS.gif","141.gif":"AbUZMn.gif","142.gif":"AbUExs.gif","143.gif":"AbUA2j.gif","144.gif":"AbUMIU.gif","145.gif":"AbUerq.gif","146.gif":"AbUKaT.gif","147.gif":"AbUmq0.gif","148.gif":"AbUuZV.gif","149.gif":"AbUliF.gif","150.gif":"AbU1G4.gif","151.gif":"AbU8z9.gif","152.gif":"AbU3RJ.gif","153.gif":"AbUYs1.gif","154.gif":"AbUJMR.gif","155.gif":"AbUadK.gif","156.gif":"AbUtqx.gif","157.gif":"AbUUZ6.gif","158.gif":"AbUBJe.gif","159.gif":"AbUdIO.gif","160.gif":"AbU0iD.gif","161.gif":"AbUrzd.gif","162.gif":"AbUDRH.gif","163.gif":"AbUyQA.gif","164.gif":"AbUWo8.gif","165.gif":"AbU6sI.gif","166.gif":"AbU2eP.gif","167.gif":"AbUcLt.gif","168.gif":"AbU4Jg.gif","169.gif":"AbURdf.gif","170.gif":"AbUhFS.gif","171.gif":"AbU5WQ.gif","172.gif":"AbULwV.gif","173.gif":"AbUIzj.gif","174.gif":"AbUTQs.gif","175.gif":"AbU7yn.gif","176.gif":"AbUqe0.gif","177.gif":"AbUHLq.gif","178.gif":"AbUOoT.gif","179.gif":"AbUvYF.gif","180.gif":"AbUjFU.gif","181.gif":"AbaSSJ.gif","182.gif":"AbUxW4.gif","183.gif":"AbaCO1.gif","184.gif":"Abapl9.gif","185.gif":"Aba9yR.gif","186.gif":"AbaFw6.gif","187.gif":"Abaiex.gif","188.gif":"AbakTK.gif","189.gif":"AbaZfe.png","190.gif":"AbaEFO.gif","191.gif":"AbaVYD.gif","192.gif":"AbamSH.gif","193.gif":"AbaKOI.gif","194.gif":"Abanld.gif","195.gif":"Abau6A.gif","196.gif":"AbaQmt.gif","197.gif":"Abal0P.gif","198.gif":"AbatpQ.gif","199.gif":"Aba1Tf.gif","200.png":"Aba8k8.png","201.png":"AbaGtS.png","202.png":"AbaJfg.png","203.png":"AbaNlj.png","204.png":"Abawmq.png","205.png":"AbaU6s.png","206.png":"AbaaXn.png","207.png":"Aba000.png","208.png":"AbarkT.png","209.png":"AbastU.png","210.png":"AbaB7V.png","211.png":"Abafn1.png","212.png":"Abacp4.png","213.png":"AbayhF.png","214.png":"Abag1J.png","215.png":"Aba2c9.png","216.png":"AbaRXR.png","217.png":"Aba476.png","218.png":"Abah0x.png","219.png":"Abdg58.png"},windowsState:"",redenvelopeData:{rid:null,from:null,face:null,blessing:null,money:null}}},created:function(){var e,t,s=this,n=this,o=JSON.parse(i.getStorageSync("userInfo")),r=getCurrentPages(),l=r[r.length-1].options;void 0==l&&(l={type:2,id:"zyj"}),n.action=l.type,n.msgBody.action=n.action,2==n.action?(console.log("一对一聊天"),console.log(n.friendList),e=n.friendList.find((function(i){return i.user.userAccount==l.id})),console.log(e),i.setNavigationBarTitle({title:null!=e.user.userName?e.user.userName:e.user.userAccount}),this.optionName=null!=e.user.userName?e.user.userName:e.user.userAccount,this.msgBody.receiveAccount=e.user.userAccount):(console.log("群聊天"),t=n.groupList.find((function(i){return i.id==l.id})),i.setNavigationBarTitle({title:t.userGroupName}),this.optionName=t.userGroupName,this.msgBody.receiveAccount=t.id),n.socketTask.onMessage((function(i){console.log("收到了一条消息！");var t=JSON.parse(i.data);console.log(n.optionName),2==t.action?e.user.userAccount==t.sourceAccount&&(console.log(t.sourceAccount+"发来了新消息"),"text"!=t.header.type?(console.log(t.msgBody),(0,g.base64ToPath)(t.msgBody).then((function(i){n.msgs.push({id:t.id,isSys:!1,isme:!1,msg:i,type:t.header.type,voiceLength:t.header.voiceLength,img:{w:t.header.imgw,h:t.header.imgh}}),n.jumpScroll()}))):(n.msgs.push({id:t.id,isSys:!1,isme:!1,msg:t.msgBody,type:t.header.type,voiceLength:t.header.voiceLength,img:{w:t.header.imgw,h:t.header.imgh}}),n.jumpScroll())):3==t.action&&(n.userName!=t.sourceAccount&&n.msgs.push({id:t.id,isSys:!1,isme:!1,msg:t.msgBody,sourceName:t.sourceAccount,type:t.header.type,img:{w:t.header.imgw,h:t.header.imgh}}),n.jumpScroll())})),n.setTalkSession(o.userName+"_talkSession_"+this.optionName),null!=n.msgList&&""!=n.msgList||(n.msgList=[]),n.msgList.forEach((function(i){i.optionId==s.optionName&&(i.waitReadMsgNum=0)})),console.log(n.msgList),n.setMsgList(n.msgList),i.getStorage({key:o.userName+"_allMsg_"+l.id}).then((function(i){i=i.filter((function(i){return null!=i})),""==i[0].data&&(i[0].data="[]"),i=JSON.parse(i[0].data),console.log(i),2==n.action?i.forEach((function(i){i.sourceAccount==o.userName?n.msgs.push({id:i.header.id,isSys:!1,isme:!0,msg:i.msgBody,type:i.header.type,voiceLength:i.header.voiceLength,img:{w:i.header.imgw,h:i.header.imgh}}):n.msgs.push({id:i.header.id,isSys:!1,isme:!1,msg:i.msgBody,type:i.header.type,voiceLength:i.header.voiceLength,img:{w:i.header.imgw,h:i.header.imgh}})})):i.forEach((function(i){i.sourceAccount==o.userName?n.msgs.push({id:i.header.id,isSys:!1,isme:!0,msg:i.msgBody,type:i.header.type,img:{w:i.header.imgw,h:i.header.imgh}}):n.msgs.push({id:i.header.id,isSys:!1,isme:!1,msg:i.msgBody,sourceName:i.sourceAccount,type:i.header.type,img:{w:i.header.imgw,h:i.header.imgh}})})),console.log(n.msgs),s.jumpScroll()}))},onLoad:function(i){var e=this;this.AUDIO.onEnded((function(i){e.playMsgid=null})),this.RECORDER.onStart((function(i){e.recordBegin(i)})),this.RECORDER.onStop((function(i){e.recordEnd(i)}))},onShow:function(){this.scrollTop=9999999},methods:r(r({},(0,s.mapMutations)(["login","setMsgList","setTalkSession","removeTalkSession"])),{},{screenMsg:function(e){if(e.isSys)switch(e.type){case"text":this.addSystemTextMsg(e);break;case"redEnvelope":this.addSystemRedEnvelopeMsg(e);break}else if(!e.isSys){switch(e.type){case"text":this.addTextMsg(e);break;case"voice":e.url=e.msg.url,e.voiceLength=e.msg.voiceLength,e.msg=e.msg.base64,this.addVoiceMsg(e);break;case"img":e.img.url=e.msg.url,e.img.w=e.msg.w,e.msg.h=e.msg.h,e.msg=e.msg.base64,console.log(e),this.addImgMsg(e);break;case"redEnvelope":this.addRedEnvelopeMsg(e);break}console.log("用户消息"),e.isme||(console.log("振动"),i.vibrateLong())}this.$nextTick((function(){console.log("滚动到底msg"+JSON.stringify(e)),this.scrollToView="msg"+e.id}))},loadHistory:function(i){},getMsgList:function(){for(var i=0;i<list.length;i++)"user"==list[i].type&&"img"==list[i].msg.type&&(list[i].msg.content=this.setPicSize(list[i].msg.content),this.msgImgList.push(list[i].msg.content.url));this.msgs=list,this.$nextTick((function(){this.scrollTop=999999,this.$nextTick((function(){this.scrollAnimation=!0}))}))},setPicSize:function(e){var t=i.upx2px(350),s=i.upx2px(350);if(e.w>t||e.h>s){var g=e.w/e.h;e.w=g>1?t:s*g,e.h=g>1?t/g:s}return e},showMore:function(){this.isVoice=!1,this.hideEmoji=!0,this.hideMore?(this.hideMore=!1,this.openDrawer()):this.hideDrawer()},openDrawer:function(){this.popupLayerClass="showLayer"},hideDrawer:function(){var i=this;this.popupLayerClass="",setTimeout((function(){i.hideMore=!0,i.hideEmoji=!0}),150)},chooseImage:function(){this.getImage("album")},camera:function(){this.getImage("camera")},handRedEnvelopes:function(){console.log("发红包"),this.hideDrawer()},app_img:function(e,t){var s=this,n=t.tempFiles[e].path.lastIndexOf("."),o=t.tempFiles[e].path.substring(n+1,t.tempFiles[e].path.length),r=t.tempFiles[e].path.substring(0,n),l=(new Date).getTime();i.getImageInfo({src:t.tempFilePaths[e],success:function(i){console.log(i.width),console.log(i.height),plus.zip.compressImage({src:t.tempFiles[e].path,dst:r+l+"."+o,quality:10},(function(n){var o=this;console.log("Compress success!",n.target),(0,g.pathToBase64)(n.target).then((function(s){console.log(s.length);var g={url:t.tempFilePaths[e],base64:s,w:i.width,h:i.height};o.sendMsg(g,"img")})),e!=t.tempFiles.length-1&&(s.app_img(e+1,t),console.log("end",s.materialList))}),(function(i){console.log("Compress error!"),console.log(JSON.stringify(i))}))}})},getImage:function(e){var t=this;this.hideDrawer(),i.chooseImage({sourceType:[e],sizeType:["original","compressed"],success:function(e){for(var s=function(s){i.getImageInfo({src:e.tempFilePaths[s],success:function(i){console.log(i.width),console.log(i.height),(0,g.pathToBase64)(e.tempFilePaths[s]).then((function(g){console.log(g.length);var n={url:e.tempFilePaths[s],base64:g,w:i.width,h:i.height};t.sendMsg(n,"img")}))}})},n=0;n<e.tempFilePaths.length;n++)s(n);console.log(i.getSystemInfoSync().platform)}})},chooseEmoji:function(){this.hideMore=!0,this.hideEmoji?(this.hideEmoji=!1,this.openDrawer()):this.hideDrawer()},addEmoji:function(i){this.textMsg+=i.alt},textareaFocus:function(){"showLayer"==this.popupLayerClass&&0==this.hideMore&&this.hideDrawer()},sendText:function(){if(this.hideDrawer(),this.textMsg){var i=this.replaceEmoji(this.textMsg);this.sendMsg(i,"text"),this.textMsg=""}},replaceEmoji:function(i){var e=this,t=i.replace(/\[([^(\]|\[)]*)\]/g,(function(i,t){console.log("item: "+i);for(var s=0;s<e.emojiList.length;s++)for(var g=e.emojiList[s],n=0;n<g.length;n++){var o=g[n];if(o.alt==i){var r="https://s2.ax1x.com/2019/04/12/",l='<img src="'+r+e.onlineEmoji[o.url]+'">';return console.log("imgstr: "+l),l}}}));return'<div style="display: flex;align-items: center;word-wrap:break-word;">'+t+"</div>"},sendMsg:function(i,e){var t=new Date,s=t.getTime(),g={isme:!0,msg:i,type:e,isSys:!1,id:s,time:t.getHours()+":"+t.getMinutes(),img:{}};console.log(this.msgs),console.log("发送了消息："+JSON.stringify(g)+"消息id是"+g.id),this.screenMsg(g)},addTextMsg:function(i){var e=JSON.parse(JSON.stringify(this.msgBody));e.msgBody=i.msg,e.header.id=i.id,e.header.type="text",e.sourceAccount=this.userName,this.socketTask.send({data:JSON.stringify(e)}),this.msgs.push(i),this.scrollTop=999999999,this.$nextTick((function(){this.scrollAnimation=!0}))},app_voice:function(i,e){var t=i.url.lastIndexOf("."),s=i.url.substring(t+1,i.url.length),n=i.url.substring(0,t),o=(new Date).getTime();plus.zip.compress({src:url,dst:n+o+"."+s,quality:10},(function(t){var s=this;console.log("CompressFile success!",t.target),(0,g.pathToBase64)(t.target).then((function(t){console.log(t.length),i.base64=t,s.sendMsg(i,e)}))}),(function(i){console.log("Compress error!"),console.log(JSON.stringify(i))}))},addVoiceMsg:function(i){var e=JSON.parse(JSON.stringify(this.msgBody));e.header.voiceLength=i.voiceLength,e.header.id=i.id,e.msgBody=i.msg,e.sourceAccount=this.userName,e.header.type="voice",i.msg=i.url,console.log("发送消息:"+JSON.stringify(e)),this.socketTask.send({data:JSON.stringify(e)}),this.msgs.push(i)},addImgMsg:function(i){var e=this,t=JSON.parse(JSON.stringify(this.msgBody));t.header.id=i.id,t.msgBody=i.msg,t.sourceAccount=e.userName,t.header.type="img",t.header.imgw=i.img.w,t.header.imgh=i.img.h,console.log(i),e.socketTask.send({data:JSON.stringify(t)}),i=this.setPicSize(i),this.msgs.push(i)},addRedEnvelopeMsg:function(i){msgBody.header.id=i.id,msgBody.msgBody=i.msg,msgBody.sourceAccount=that.userName,msgBody.header.type="voice",console.log(i),that.socketTask.send({data:JSON.stringify(msgBody)}),this.msgs.push(i)},addSystemTextMsg:function(i){this.msgs.push(i)},addSystemRedEnvelopeMsg:function(i){this.msgs.push(i)},openRedEnvelope:function(e,t){var s=this,g=e.content.rid;i.showLoading({title:"加载中..."}),console.log("index: "+t),setTimeout((function(){s.redenvelopeData=0==g?{rid:0,from:"大黑哥",face:"/static/img/im/face/face.jpg",blessing:"恭喜发财，大吉大利",money:"已领完"}:{rid:1,from:"售后客服008",face:"/static/img/im/face/face_2.jpg",blessing:"恭喜发财",money:"0.01"},i.hideLoading(),s.windowsState="show"}),200)},closeRedEnvelope:function(){var i=this;this.windowsState="hide",setTimeout((function(){i.windowsState=""}),200)},sendSystemMsg:function(i,e){var t=this.msgs[this.msgs.length-1].msg.id;t++;var s={type:"system",msg:{id:t,type:e,content:i}};this.screenMsg(s)},toDetails:function(i){console.log("领取详情界面")},showPic:function(e){i.previewImage({indicator:"none",current:e.content.url,urls:this.msgImgList})},playVoice:function(i){console.log("即将播放录音："+JSON.stringify(i)),this.playMsgid=i.id,this.AUDIO.src=i.msg,this.$nextTick((function(){this.AUDIO.play()}))},voiceBegin:function(i){i.touches.length>1||(this.initPoint.Y=i.touches[0].clientY,this.initPoint.identifier=i.touches[0].identifier,this.RECORDER.start({format:"mp3"}))},recordBegin:function(i){var e=this;this.recording=!0,this.voiceTis="松开 结束",this.recordLength=0,this.recordTimer=setInterval((function(){e.recordLength++}),1e3)},voiceCancel:function(){this.recording=!1,this.voiceTis="按住 说话",this.recordTis="手指上滑 取消发送",this.willStop=!0,this.RECORDER.stop()},voiceIng:function(e){if(this.recording){var t=e.touches[0];this.initPoint.Y-t.clientY>=i.upx2px(100)?(this.willStop=!0,this.recordTis="松开手指 取消发送"):(this.willStop=!1,this.recordTis="手指上滑 取消发送")}},voiceEnd:function(i){this.recording&&(this.recording=!1,this.voiceTis="按住 说话",this.recordTis="手指上滑 取消发送",this.RECORDER.stop())},recordEnd:function(i){var e=this;if(clearInterval(this.recordTimer),this.willStop)console.log("取消发送录音");else{console.log("e: "+JSON.stringify(i));var t={voiceLength:0,url:i.tempFilePath},s=parseInt(this.recordLength/60),n=this.recordLength%60;s=s<10?"0"+s:s,n=n<10?"0"+n:n,t.voiceLength=s+":"+n,(0,g.pathToBase64)(i.tempFilePath).then((function(i){t.base64=i,e.sendMsg(t,"voice")}))}this.willStop=!1},switchVoice:function(){this.hideDrawer(),this.isVoice=!this.isVoice},discard:function(){},jumpScroll:function(){var i=this;console.log(i.msgs),0!=i.msgs.length&&this.$nextTick((function(){i.scrollToView="msg"+i.msgs[i.msgs.length-1].id}))}})};e.default=f}).call(this,t("543d")["default"])},"9ecb":function(i,e,t){"use strict";t.r(e);var s=t("bab6"),g=t("347e");for(var n in g)"default"!==n&&function(i){t.d(e,i,(function(){return g[i]}))}(n);t("441a");var o,r=t("f0c5"),l=Object(r["a"])(g["default"],s["b"],s["c"],!1,null,null,null,!1,s["a"],o);e["default"]=l.exports},bab6:function(i,e,t){"use strict";t.d(e,"b",(function(){return g})),t.d(e,"c",(function(){return n})),t.d(e,"a",(function(){return s}));var s={uCol:function(){return t.e("node-modules/uview-ui/components/u-col/u-col").then(t.bind(null,"eaeb"))},avatar:function(){return t.e("components/avatar/avatar").then(t.bind(null,"3c0c"))}},g=function(){var i=this,e=i.$createElement;i._self._c},n=[]}},[["765e","common/runtime","common/vendor"]]]);