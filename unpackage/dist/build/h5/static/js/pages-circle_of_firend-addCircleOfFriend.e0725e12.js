(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-circle_of_firend-addCircleOfFriend"],{"0019":function(r,n,t){"use strict";t.r(n);var e=t("4832"),i=t.n(e);for(var a in e)"default"!==a&&function(r){t.d(n,r,(function(){return e[r]}))}(a);n["default"]=i.a},"06c5":function(r,n,t){"use strict";t("a630"),t("fb6a"),t("d3b7"),t("25f0"),t("3ca3"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var e=i(t("6b75"));function i(r){return r&&r.__esModule?r:{default:r}}function a(r,n){if(r){if("string"===typeof r)return(0,e.default)(r,n);var t=Object.prototype.toString.call(r).slice(8,-1);return"Object"===t&&r.constructor&&(t=r.constructor.name),"Map"===t||"Set"===t?Array.from(r):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?(0,e.default)(r,n):void 0}}},"0af9":function(r,n,t){var e=t("714a");"string"===typeof e&&(e=[[r.i,e,""]]),e.locals&&(r.exports=e.locals);var i=t("4f06").default;i("4cb9bd0e",e,!0,{sourceMap:!1,shadowMode:!1})},"10cc":function(r,n,t){"use strict";var e=t("4ea4");t("4160"),t("a434"),t("159b"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=e(t("5530")),a=e(t("7ef4")),o=(e(t("312b")),t("2f62")),s={data:function(){return{list:[],commentSwitch:!0,text:"",uploadFilePathArray:[]}},onLoad:function(){},computed:(0,i.default)({},(0,o.mapState)(["userName"])),methods:{publishCircle:function(){var r=this,n=this.uploadFilePathArray;console.log(n),console.log(this.text);var t=[];n.forEach((function(r){t.push(r.src)})),0!=t.length?(a.default.batchUploadFile(t).then((function(n){console.log(n),1!=n.length?(n=JSON.parse(n[1].data),200!=n.code?uni.showToast({title:n.msg}):a.default.addCircleOfFriendInfo(r.text,n.data).then((function(r){uni.navigateBack()}))):uni.showToast({title:"异常"})})),console.log(t)):a.default.addCircleOfFriendInfo(this.text,"").then((function(r){uni.navigateBack()}))},onAlbumSort:function(r){console.info("排序成功")},onAlbumClick:function(r){uni.previewImage(r.index,r.list)},onAlbumAdd:function(r){console.info("新增成功"),console.log(r),this.uploadFilePathArray.push(r),this.$refs.rAlbum.add({id:Math.floor(1e3*Math.random()+1),sortID:r.sortID,src:r.src})},onAlbumDelete:function(r){console.info("删除成功"),console.log(r),console.log(this.list),this.uploadFilePathArray.splice(r.sortID,1),console.log(this.uploadFilePathArray)}}};n.default=s},"1b90":function(r,n,t){"use strict";t.r(n);var e=t("a53e"),i=t("6e85");for(var a in i)"default"!==a&&function(r){t.d(n,r,(function(){return i[r]}))}(a);t("7dd1");var o,s=t("f0c5"),d=Object(s["a"])(i["default"],e["b"],e["c"],!1,null,"6f4477df",null,!1,e["a"],o);n["default"]=d.exports},"1f86":function(r,n,t){"use strict";t.r(n);var e=t("890d"),i=t("43aa");for(var a in i)"default"!==a&&function(r){t.d(n,r,(function(){return i[r]}))}(a);t("5383");var o,s=t("f0c5"),d=Object(s["a"])(i["default"],e["b"],e["c"],!1,null,"39be3c80",null,!1,e["a"],o);n["default"]=d.exports},2909:function(r,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=d;var e=s(t("6005")),i=s(t("db90")),a=s(t("06c5")),o=s(t("3427"));function s(r){return r&&r.__esModule?r:{default:r}}function d(r){return(0,e.default)(r)||(0,i.default)(r)||(0,a.default)(r)||(0,o.default)()}},"2cef":function(r,n,t){var e=t("24fb");n=e(!1),n.push([r.i,"/* uni.scss */.u-image[data-v-8cb37952]{position:relative;-webkit-transition:opacity .5s ease-in-out;transition:opacity .5s ease-in-out}.u-image__image[data-v-8cb37952]{width:100%;height:100%}.u-image__loading[data-v-8cb37952], .u-image__error[data-v-8cb37952]{position:absolute;top:0;left:0;width:100%;height:100%;\ndisplay:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;\n-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;background-color:#f3f4f6;color:#909399;font-size:%?46?%}",""]),r.exports=n},3427:function(r,n,t){"use strict";function e(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}Object.defineProperty(n,"__esModule",{value:!0}),n.default=e},"43aa":function(r,n,t){"use strict";t.r(n);var e=t("10cc"),i=t.n(e);for(var a in e)"default"!==a&&function(r){t.d(n,r,(function(){return e[r]}))}(a);n["default"]=i.a},4832:function(r,n,t){"use strict";t("a9e3"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var e={name:"u-image",props:{src:{type:String,default:""},mode:{type:String,default:"aspectFill"},width:{type:[String,Number],default:"100%"},height:{type:[String,Number],default:"auto"},shape:{type:String,default:"square"},borderRadius:{type:[String,Number],default:0},lazyLoad:{type:Boolean,default:!0},showMenuByLongpress:{type:Boolean,default:!0},loadingIcon:{type:String,default:"photo"},errorIcon:{type:String,default:"error-circle"},showLoading:{type:Boolean,default:!0},showError:{type:Boolean,default:!0},fade:{type:Boolean,default:!0},webp:{type:Boolean,default:!1},duration:{type:[String,Number],default:500},bgColor:{type:String,default:"#f3f4f6"}},data:function(){return{isError:!1,loading:!0,opacity:1,durationTime:this.duration,backgroundStyle:{}}},watch:{src:{immediate:!0,handler:function(r){r?this.isError=!1:(this.isError=!0,this.loading=!1)}}},computed:{wrapStyle:function(){var r={};return r.width=this.$u.addUnit(this.width),r.height=this.$u.addUnit(this.height),r.borderRadius="circle"==this.shape?"50%":this.$u.addUnit(this.borderRadius),r.overflow=this.borderRadius>0?"hidden":"visible",this.fade&&(r.opacity=this.opacity,r.transition="opacity ".concat(Number(this.durationTime)/1e3,"s ease-in-out")),r}},methods:{onClick:function(){this.$emit("click")},onErrorHandler:function(){this.loading=!1,this.isError=!0,this.$emit("error")},onLoadHandler:function(){var r=this;if(this.loading=!1,this.isError=!1,this.$emit("load"),!this.fade)return this.removeBgColor();this.opacity=0,this.durationTime=0,setTimeout((function(){r.durationTime=r.duration,r.opacity=1,setTimeout((function(){r.removeBgColor()}),r.durationTime)}),50)},removeBgColor:function(){this.backgroundStyle={backgroundColor:"transparent"}}}};n.default=e},5383:function(r,n,t){"use strict";var e=t("910d"),i=t.n(e);i.a},6005:function(r,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=a;var e=i(t("6b75"));function i(r){return r&&r.__esModule?r:{default:r}}function a(r){if(Array.isArray(r))return(0,e.default)(r)}},"6b75":function(r,n,t){"use strict";function e(r,n){(null==n||n>r.length)&&(n=r.length);for(var t=0,e=new Array(n);t<n;t++)e[t]=r[t];return e}Object.defineProperty(n,"__esModule",{value:!0}),n.default=e},"6e85":function(r,n,t){"use strict";t.r(n);var e=t("d385"),i=t.n(e);for(var a in e)"default"!==a&&function(r){t.d(n,r,(function(){return e[r]}))}(a);n["default"]=i.a},"714a":function(r,n,t){var e=t("24fb");n=e(!1),n.push([r.i,"\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n/* 页面布局样式BEGIN */.dragsort-box[data-v-6f4477df]{width:100%;height:100%;overflow:hidden}.dragsort-area[data-v-6f4477df]{width:100%;height:100%\r\n\t/* width: calc(100% - 60rpx);\r\n\theight: calc(100% - 40rpx);\r\n\tpadding: 20rpx 30rpx; */}\r\n/* 需要撑开拖拽内容区域高度 */.dragsort-delete[data-v-6f4477df]{position:fixed;bottom:0;left:0;z-index:100;width:100%;\r\n\t/* padding: 14rpx 0; */height:%?90?%;background-color:#dd6161;color:#fff;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-justify-content:space-around;justify-content:space-around;opacity:0}.opacity[data-v-6f4477df]{opacity:1}.deleteicon[data-v-6f4477df]{font-size:17px}.dragsort-view[data-v-6f4477df]{position:absolute!important;display:-webkit-box;display:-webkit-flex;display:flex;\r\n\t/* height: 80px; */-webkit-box-align:center;-webkit-align-items:center;align-items:center;\r\n\t/* width: 20%; */text-align:center;\r\n\t/* background-color: #C0C4CC; */color:#fff;\r\n\t/* border-radius: 5px; */box-sizing:border-box;z-index:90}.dragsort-view-active[data-v-6f4477df]{\r\n\t/* box-shadow: 0 0 40rpx #DDDDDD; */z-index:99}.dragsort-view-item[data-v-6f4477df]{position:relative;-webkit-box-flex:1;-webkit-flex:1;flex:1;font-size:16px;width:100%;height:100%}.dragsort-view-item-image[data-v-6f4477df]{\r\n\t/* width: 100%; */}.btnAdd[data-v-6f4477df]{background-color:#f7f7f7;height:100%;width:100%;display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-direction:row;flex-direction:row;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;align-items:center}.btnAdd-icon[data-v-6f4477df]{color:#b2b2b2;font-size:%?90?%}\r\n/* 页面布局样式END */",""]),r.exports=n},"743f":function(r,n,t){var e=t("24fb");n=e(!1),n.push([r.i,".album-content[data-v-39be3c80]{width:100%;height:calc(100vh - var(--window-top) - var(--window-bottom));font-size:13px}.paddingLR30[data-v-39be3c80]{padding-left:%?30?%;padding-right:%?30?%}.paddingT20[data-v-39be3c80]{padding-top:%?20?%}.paddingB20[data-v-39be3c80]{padding-bottom:%?20?%}",""]),r.exports=n},"7dd1":function(r,n,t){"use strict";var e=t("0af9"),i=t.n(e);i.a},"890d":function(r,n,t){"use strict";t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return a})),t.d(n,"a",(function(){return e}));var e={rAlbum:t("1b90").default,uInput:t("36c5").default,uButton:t("5baa").default},i=function(){var r=this,n=r.$createElement,t=r._self._c||n;return t("v-uni-view",{staticClass:"album-content"},[t("r-album",{ref:"rAlbum",on:{sort:function(n){arguments[0]=n=r.$handleEvent(n),r.onAlbumSort.apply(void 0,arguments)},click:function(n){arguments[0]=n=r.$handleEvent(n),r.onAlbumClick.apply(void 0,arguments)},add:function(n){arguments[0]=n=r.$handleEvent(n),r.onAlbumAdd.apply(void 0,arguments)},delete:function(n){arguments[0]=n=r.$handleEvent(n),r.onAlbumDelete.apply(void 0,arguments)}},scopedSlots:r._u([{key:"before",fn:function(){return[t("v-uni-view",{staticClass:"paddingLR30 paddingT20"},[t("u-input",{attrs:{type:"textarea",focus:!1,maxlength:60,placeholder:"发表新动态..."},model:{value:r.text,callback:function(n){r.text=n},expression:"text"}})],1)]},proxy:!0},{key:"after",fn:function(){return[t("v-uni-view",{staticClass:"paddingLR30 paddingB20"},[t("u-button",{on:{click:function(n){arguments[0]=n=r.$handleEvent(n),r.publishCircle.apply(void 0,arguments)}}},[r._v("发布")])],1)]},proxy:!0}]),model:{value:r.list,callback:function(n){r.list=n},expression:"list"}})],1)},a=[]},"910d":function(r,n,t){var e=t("743f");"string"===typeof e&&(e=[[r.i,e,""]]),e.locals&&(r.exports=e.locals);var i=t("4f06").default;i("60b30862",e,!0,{sourceMap:!1,shadowMode:!1})},a53e:function(r,n,t){"use strict";t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return a})),t.d(n,"a",(function(){return e}));var e={uImage:t("dfcd").default,uIcon:t("6be5").default},i=function(){var r=this,n=r.$createElement,t=r._self._c||n;return t("v-uni-view",{staticClass:"dragsort-box"},[t("v-uni-movable-area",{staticClass:"dragsort-area",attrs:{id:"drag"}},[t("v-uni-view",{staticClass:"dragsort-before",attrs:{id:"dragsort-before"}},[r._t("before")],2),t("v-uni-view",{staticClass:"dragsort-list",style:{height:r.listHeight+"px"},attrs:{id:"dragsort-list"}}),r._l(r.list,(function(n,e){return t("v-uni-movable-view",{key:e,staticClass:"dragsort-view",class:{"dragsort-view-active":r.isDrag&&r.activeModel&&r.activeModel.id==n.id},style:{width:n.width+"px",height:n.height+"px"},attrs:{x:n.x,y:n.y,"data-id":n.id,"data-sortid":n.sortID,"data-isadd":n.isAdd,direction:n.direction,damping:"40",animation:n.animation,disabled:n.disabled},on:{touchstart:function(n){arguments[0]=n=r.$handleEvent(n),r.touchstart.apply(void 0,arguments)},touchmove:function(n){n.stopPropagation(),arguments[0]=n=r.$handleEvent(n),r.touchmove.apply(void 0,arguments)},touchend:function(n){arguments[0]=n=r.$handleEvent(n),r.touchend.apply(void 0,arguments)}}},[n.isAdd?r._e():t("v-uni-view",{staticClass:"dragsort-view-item",on:{click:function(t){t.stopPropagation(),arguments[0]=t=r.$handleEvent(t),r.onClick(n,e,r.list)}}},[t("u-image",{attrs:{width:"100%",height:"100%",src:r.fixResourcesUrl(n.src)}})],1),n.isAdd?t("v-uni-view",{staticClass:"dragsort-view-item",on:{click:function(n){n.stopPropagation(),arguments[0]=n=r.$handleEvent(n),r.onAdd.apply(void 0,arguments)}}},[t("v-uni-view",{staticClass:"btnAdd"},[t("u-icon",{staticClass:"btnAdd-icon",attrs:{name:"plus",color:"#B2B2B2",size:"90"}})],1)],1):r._e()],1)})),t("v-uni-view",{staticClass:"dragsort-after",attrs:{id:"dragsort-after"}},[r._t("after")],2),t("v-uni-view",{staticClass:"dragsort-delete",class:r.isDrag?"opacity":"",attrs:{id:"dragsort-delete"}},[t("u-icon",{staticClass:"deleteicon",attrs:{name:"trash",color:"#FFFFFF",size:"34"}}),t("v-uni-view",[r._v(r._s(r.deleteText))])],1)],2)],1)},a=[]},b340:function(r,n,t){"use strict";var e=t("bf19"),i=t.n(e);i.a},bf19:function(r,n,t){var e=t("2cef");"string"===typeof e&&(e=[[r.i,e,""]]),e.locals&&(r.exports=e.locals);var i=t("4f06").default;i("b009ab26",e,!0,{sourceMap:!1,shadowMode:!1})},d385:function(r,n,t){"use strict";var e=t("4ea4");t("4de4"),t("d81d"),t("fb6a"),t("4e82"),t("a434"),t("a9e3"),t("ac1f"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=e(t("5530")),a=e(t("2909")),o=0,s=300,d=0,l=300,u=0,c=10,h=null,f={name:"drag-sort",mixins:[],components:{},data:function(){return{list:[],row:0,width:0,height:0,windowWidth:0,listHeight:0,beforeHeight:0,afterHeight:0,topY:0,topX:0,activeModel:null,activeX:0,activeY:0,targetModel:null,targetX:0,targetY:0,isDrag:!1,deleteArea:null,deleteText:"拖动到此处删除",modelCount:0,maxSortID:0,addObject:null,isUpdate:!1}},computed:{},props:{value:{type:Array,default:function(){return[]}},column:{type:Number,default:function(){return 3}},maxCount:{type:Number,default:function(){return 9}},areaXGap:{type:Number,default:function(){return 15}},areaYGap:{type:Number,default:function(){return 10}},viewGap:{type:Number,default:function(){return 4}}},watch:{value:{handler:function(){this.reset(),this.init(),this.initGrid()},deep:!0}},created:function(){var r=uni.getSystemInfoSync();this.windowWidth=r.windowWidth},mounted:function(){this.$nextTick((function(){var r=this,n=uni.createSelectorQuery().in(this);n.select("#dragsort-before").boundingClientRect(),n.select("#dragsort-after").boundingClientRect(),n.exec((function(n){r.beforeHeight=n[0].height,r.afterHeight=n[1].height,r.init(),r.initGrid()}))}))},updated:function(){},filters:{},methods:{reset:function(){this.addObject=null},init:function(){var r=[];this.value&&this.value.length>0&&r.push.apply(r,(0,a.default)(this.value)),r.sort((function(r,n){return r.sortID-n.sortID})),r.length>=this.maxCount?(this.list=r.slice(0,this.maxCount),this.modelCount=this.maxCount,this.maxSortID=this.list[this.list.length-1].sortID):r.length<this.maxCount&&(this.list=r,r.length>0&&(this.modelCount=this.list.length,this.maxSortID=this.list[this.list.length-1].sortID),this.list.push({id:0,sortID:1e4,src:"",isAdd:!0}))},initGrid:function(){var r=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.list,t=[],e=0;if(n&&n.length>0){this.row=Math.ceil(n.length/this.column),this.height=this.width=(this.windowWidth-2*this.areaXGap-(this.column-1)*this.viewGap)/this.column,this.listHeight=this.height*this.row+2*this.areaYGap+(this.row-1)*this.viewGap;for(var a=function(){var a=(o-1)*r.column,s=o*r.column;s=s>n.length?n.length:s;var d=n.slice(a,s),l=r.areaXGap,u=r.beforeHeight+r.areaYGap+(o-1)*(r.height+r.viewGap);d.map((function(n,a){e=0==a?l:l+a*(r.width+r.viewGap),n.isAdd?(r.addObject=(0,i.default)((0,i.default)({},n),{},{y:u,x:e,direction:"all",disabled:!0,animation:!0,rowNumber:o,columnNumber:a+1,width:r.width,height:r.height}),t.push(r.addObject)):t.push((0,i.default)((0,i.default)({},n),{},{y:u,x:e,direction:"all",disabled:!1,animation:!0,rowNumber:o,columnNumber:a+1,width:r.width,height:r.height}))}))},o=1;o<=this.row;o++)a()}this.list=t},fixResourcesUrl:function(r){return r},findTarget:function(r,n){var t=this;if(null!=this.activeModel){var e=!0;this.list.map((function(i,a){i.x<r&&r<=i.x+t.width&&n>i.y&&n<=i.y+t.height&&t.activeModel.id!=i.id&&!i.isAdd&&(e=!1,t.targetModel=i,t.isUpdate=!0)})),!e&&this.isUpdate&&this.updateList()}},updateList:function(){this.targetX=this.targetModel.x,this.targetY=this.targetModel.y;var r=this.targetModel.sortID,n=this.targetModel.rowNumber,t=this.targetModel.columnNumber;if(this.activeModel.sortID>r)if(this.activeModel.rowNumber==n)for(var e=this.activeModel.sortID-1;e>=r;e--){var i=this.getModelBySortID(e);i.x=i.x+(this.width+this.viewGap),i.sortID++,i.columnNumber++}else for(e=this.activeModel.sortID-1;e>=r;e--){i=this.getModelBySortID(e);i.sortID++,i.columnNumber==this.column?(i.columnNumber=1,i.rowNumber++,i.y=this.beforeHeight+this.areaYGap+(i.rowNumber-1)*(this.height+this.viewGap),i.x=this.areaXGap+(i.columnNumber-1)*(this.width+this.viewGap)):(i.x=i.x+(this.width+this.viewGap),i.columnNumber++)}else if(this.activeModel.sortID<r)if(this.activeModel.rowNumber==n)for(e=this.activeModel.sortID+1;e<=r;e++){i=this.getModelBySortID(e);i.x=i.x-(this.width+this.viewGap),i.sortID--,i.columnNumber--}else for(e=this.activeModel.sortID+1;e<=r;e++){i=this.getModelBySortID(e);i.sortID--,1==i.columnNumber?(i.columnNumber=this.column,i.rowNumber--,i.y=this.beforeHeight+this.areaYGap+(i.rowNumber-1)*(this.height+this.viewGap),i.x=this.areaXGap+(i.columnNumber-1)*(this.width+this.viewGap)):(i.x=i.x-(this.width+this.viewGap),i.columnNumber--)}this.activeModel.sortID=r,this.activeModel.columnNumber=t,this.activeModel.rowNumber=n},removeItem:function(){var r=this,n=this.activeModel.sortID,t=-1;this.list.map((function(n,e){n!=r.activeModel||(t=e)})),t>-1&&this.list.splice(t,1);for(var e=this.maxSortID==n?this.activeModel:this.getModelBySortID(this.maxSortID),i=e.rowNumber,a=e.columnNumber,o=0;o<this.list.length;o++){var s=this.list[o];s.sortID>n&&(s.isAdd||s.sortID--,1==s.rowNumber?(s.x=s.x-(this.width+this.viewGap),s.columnNumber--):1==s.columnNumber?(s.columnNumber=this.column,s.rowNumber--,s.y=this.beforeHeight+this.areaYGap+(s.rowNumber-1)*(this.height+this.viewGap),s.x=this.areaXGap+(s.columnNumber-1)*(this.width+this.viewGap)):(s.x=s.x-(this.width+this.viewGap),s.columnNumber--))}this.addObject||(this.addObject={id:0,sortID:1e4,src:"",isAdd:!0,direction:"all",disabled:!0,animation:!0,rowNumber:i,columnNumber:a,width:this.width,height:this.height},this.addObject.x=this.areaXGap+(this.addObject.columnNumber-1)*(this.width+this.viewGap),this.addObject.y=this.beforeHeight+this.areaYGap+(this.addObject.rowNumber-1)*(this.height+this.viewGap),this.list.push(this.addObject)),this.listHeight=this.height*this.addObject.rowNumber+2*this.areaYGap+(this.addObject.rowNumber-1)*this.viewGap},touchstart:function(r){if(!r.currentTarget.dataset.isadd){var n=this;d=setTimeout((function(){n.isDrag=!0;var t=uni.createSelectorQuery().in(n);t.select("#drag").boundingClientRect(),t.select("#dragsort-delete").boundingClientRect(),t.exec((function(t){n.deleteArea=t[1],n.topY=t[0].top,n.topX=t[0].left,n.activeModel=n.getModel(Number(r.currentTarget.dataset.id)),n.activeModel.width+=10,n.activeModel.height+=10,n.activeX=n.activeModel.x,n.activeY=n.activeModel.y;var e=r.mp.touches[0].clientY-n.topY,i=r.mp.touches[0].clientX-n.topX,a=e-(n.height+10)/2,o=i-(n.width+10)/2;n.activeModel.y=a,n.activeModel.x=o,n.activeModel.animation=!1}))}),l)}},touchmove:function(r){if(!r.currentTarget.dataset.isadd){var n=this;u&&clearTimeout(u),u=setTimeout((function(){if(null!=n.activeModel&&!(h&&Math.abs(r.mp.touches[0].clientY-h.mp.touches[0].clientY)<20&&Math.abs(r.mp.touches[0].clientX-h.mp.touches[0].clientX)<20)){h=r;var t=r.mp.touches[0].clientY-n.topY,e=r.mp.touches[0].clientX-n.topX,i=t-(n.height+10)/2,a=e-(n.width+10)/2;n.activeModel.y=i,n.activeModel.x=a,n.activeModel.animation=!1,t>=n.deleteArea.top?n.deleteText="松手即可删除":(n.deleteText="拖动到此处删除",o&&clearTimeout(o),o=setTimeout((function(){n.findTarget(e,t)}),s))}}),c)}},getEnableUploadFiles:function(){var r=this.list.filter((function(r){return!r.isAdd}));return r},touchend:function(r){if(!r.currentTarget.dataset.isadd&&(d&&clearTimeout(d),null!=this.activeModel)){var n=r.mp.changedTouches[0].clientY-this.topY;n>=this.deleteArea.top?(this.removeItem(),this.modelCount--,this.maxSortID--,this.$emit("delete",{model:this.activeModel,list:this.list.filter((function(r){return!r.isAdd}))})):(this.activeModel.width-=10,this.activeModel.height-=10,this.targetModel?(this.activeModel.x=this.targetX,this.activeModel.y=this.targetY):(this.activeModel.x=this.activeX,this.activeModel.y=this.activeY),this.activeModel.animation=!0,this.isUpdate&&(this.isUpdate=!1,this.$emit("sort",this.list.filter((function(r){return!r.isAdd}))))),this.activeModel=null,this.targetModel=null,this.isDrag=!1,this.deleteArea=null,this.deleteText="拖动到此处删除",h=null}},getModel:function(r){if(this.list&&this.list.length>0)for(var n=0;n<this.list.length;n++)if(this.list[n].id==r)return this.list[n];return null},getModelBySortID:function(r){if(this.list&&this.list.length>0)for(var n=0;n<this.list.length;n++)if(this.list[n].sortID==r)return this.list[n];return null},onClick:function(r,n,t){this.$emit("click",{model:r,index:n,list:t.filter((function(r){return!r.isAdd}))})},onAdd:function(){var r=this;uni.chooseImage({count:9-r.modelCount,sizeType:["original","compressed"],sourceType:["album","camera"],success:function(n){n.tempFilePaths&&n.tempFilePaths.map((function(n,t){setTimeout((function(){r.maxSortID++;var t=n;r.$emit("add",{src:t,sortID:r.maxSortID})}),200)}))}})},add:function(r){if(this.addObject)if(this.modelCount++,this.list.length==this.maxCount){var n=Object.assign({},r,this.addObject);n.isAdd=!1,n.disabled=!1,n.src=r.src,n.id=r.id,n.sortID=r.sortID,this.list.splice(this.maxCount-1,1,n),this.addObject=null}else{n=Object.assign({},r,this.addObject);n.isAdd=!1,n.disabled=!1,n.src=r.src,n.id=r.id,n.sortID=r.sortID,this.list.splice(this.list.length-1,0,n),this.addObject.columnNumber==this.column?(this.addObject.columnNumber=1,this.addObject.rowNumber++,this.addObject.y=this.beforeHeight+this.areaYGap+(this.addObject.rowNumber-1)*(this.height+this.viewGap),this.addObject.x=this.areaXGap+(this.addObject.columnNumber-1)*(this.width+this.viewGap),this.listHeight=this.height*this.addObject.rowNumber+2*this.areaYGap+(this.addObject.rowNumber-1)*this.viewGap):(this.addObject.x=this.addObject.x+(this.width+this.viewGap),this.addObject.columnNumber++)}}}};n.default=f},db90:function(r,n,t){"use strict";function e(r){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(r))return Array.from(r)}t("a4d3"),t("e01a"),t("d28b"),t("a630"),t("d3b7"),t("3ca3"),t("ddb0"),Object.defineProperty(n,"__esModule",{value:!0}),n.default=e},dfcd:function(r,n,t){"use strict";t.r(n);var e=t("fedd"),i=t("0019");for(var a in i)"default"!==a&&function(r){t.d(n,r,(function(){return i[r]}))}(a);t("b340");var o,s=t("f0c5"),d=Object(s["a"])(i["default"],e["b"],e["c"],!1,null,"8cb37952",null,!1,e["a"],o);n["default"]=d.exports},fedd:function(r,n,t){"use strict";t.d(n,"b",(function(){return i})),t.d(n,"c",(function(){return a})),t.d(n,"a",(function(){return e}));var e={uIcon:t("6be5").default},i=function(){var r=this,n=r.$createElement,t=r._self._c||n;return t("v-uni-view",{staticClass:"u-image",style:[r.wrapStyle,r.backgroundStyle],on:{click:function(n){arguments[0]=n=r.$handleEvent(n),r.onClick.apply(void 0,arguments)}}},[r.isError?r._e():t("v-uni-image",{staticClass:"u-image__image",style:{borderRadius:"circle"==r.shape?"50%":r.$u.addUnit(r.borderRadius)},attrs:{src:r.src,mode:r.mode,"lazy-load":r.lazyLoad},on:{error:function(n){arguments[0]=n=r.$handleEvent(n),r.onErrorHandler.apply(void 0,arguments)},load:function(n){arguments[0]=n=r.$handleEvent(n),r.onLoadHandler.apply(void 0,arguments)}}}),r.showLoading&&r.loading?t("v-uni-view",{staticClass:"u-image__loading",style:{borderRadius:"circle"==r.shape?"50%":r.$u.addUnit(r.borderRadius),backgroundColor:this.bgColor}},[r.$slots.loading?r._t("loading"):t("u-icon",{attrs:{name:r.loadingIcon,width:r.width,height:r.height}})],2):r._e(),r.showError&&r.isError&&!r.loading?t("v-uni-view",{staticClass:"u-image__error",style:{borderRadius:"circle"==r.shape?"50%":r.$u.addUnit(r.borderRadius)}},[r.$slots.error?r._t("error"):t("u-icon",{attrs:{name:r.errorIcon,width:r.width,height:r.height}})],2):r._e()],1)},a=[]}}]);